let maintl,
	playedOnce = !1,
	seekStart = 0;

!(function () {
	gsap.set(".motion-path", { x:373 , y:14 , scaleX:1.15, scaleY:.66 });


		// Get the arch element's bounding box
		const archElement = document.querySelector("#arch");
		const archBounds = archElement.getBBox();
		const archHeight = archBounds.height;
		const archTop = archBounds.y - 50;
		const minScale = .4;
		const maxScale = 1;
		
		function onUpdate() {
			const element = this.targets()[0];
			const currentY = gsap.getProperty(element, "y");

			// Normalize Y relative to the arch's dimensions
			const relativeY = currentY - archTop; // Y position relative to arch top
			const normalizedY = Math.min(Math.max(relativeY, 0) / archHeight, 1);
			const scale = maxScale - normalizedY * (maxScale - minScale);

			gsap.set(element, { scale: scale });
		}

	let text1 = new SplitText(".text1", { type: "words", position: "relative" });
	let text2 = new SplitText(".text2", { type: "chars", position: "relative" });
	let text3 = new SplitText(".text3", { type: "chars", position: "relative" });
	// let text4 = new SplitText(".text4", { type: "chars", position: "relative" });
	let text5 = new SplitText(".text5", { type: "words", position: "relative" });

   const centerDistance = 110,
   centerRotation = 30;
   
	(maintl = gsap.timeline()),
		maintl.timeScale(1)

      // Frame 0
      .add("frame0", 0)
			.to(".stage", 0.05, { autoAlpha: 1 }, "frame1")
			.set( ".frame2-container, .background2, .ui2, .endframe-container", { autoAlpha: 0 }, "frame0" )

      // Frame 1
         .add("frame1", "+=.01")
			.from( text1.words, 0.5, { autoAlpha: 0, y: 10, stagger: 0.08, ease: Power1.easeOut }, "frame1+=.1" )


		// set A
			.to( ".icon-intro-1a", 2.5, {  motionPath: { path: "#arch", autoRotate: false, align: "#arch", alignOrigin: [0.5, 0.5], start: 0.15, end: -0.65 }, ease: Power1.easeInOut, onUpdate: onUpdate, }, "frame1")
			.to( ".icon-intro-2a", 2.5, {  motionPath: { path: "#arch", autoRotate: false, align: "#arch", alignOrigin: [0.5, 0.5], start: -0.05, end: -0.85 }, ease: Power1.easeInOut, onUpdate: onUpdate, }, "frame1")
			.to( ".icon-intro-3a", 2.5, {  motionPath: { path: "#arch", autoRotate: false, align: "#arch", alignOrigin: [0.5, 0.5], start: -0.25, end: -1.05 }, ease: Power1.easeInOut, onUpdate: onUpdate, }, "frame1")
			.to( ".icon-intro-4a", 2.5, {  motionPath: { path: "#arch", autoRotate: false, align: "#arch", alignOrigin: [0.5, 0.5], start: -0.45, end: -1.25 }, ease: Power1.easeInOut, onUpdate: onUpdate, }, "frame1")
			.to( ".icon-intro-5a", 2.5, {  motionPath: { path: "#arch", autoRotate: false, align: "#arch", alignOrigin: [0.5, 0.5], start: -0.65, end: -1.45 }, ease: Power1.easeInOut, onUpdate: onUpdate, }, "frame1")

		// Frame 2
         .add("frame2", "+=1")
			.to( ".frame1-container", 0.5, { scale: 1.08, ease: Back.easeInOut }, "frame2" )
			.set(".frame2-container", { scale: 0.5 }, "frame2")
			.to(".frame2-container", 0.5, { scale: 1 , ease: Back.easeInOut}, "frame2")
			.set( ".frame1-container, .icons-container, .right-icons-container, .center-icons-container, .text1, .white-ellipse", { autoAlpha: 0 }, "frame2+=.3" )
			.set(".frame2-container", { autoAlpha: 1 }, "frame2+=.3")
			.set(".background2", { autoAlpha: 1 }, "frame2+=.3")
			

      // Frame 3
         .add("frame3", "+=0")
			.from(text2.chars, 0.01, { autoAlpha: 0, stagger: 0.03 }, "frame3")
			.to(".pill1", 2.6, { x: 10, y: 10, ease: Power0.easeNone }, "frame3")
			.to(".pill2", 2.6, { x: -10, y: -10, ease: Power0.easeNone }, "frame3")
			.to(".ui1", 0.75, { scale: 0.8, ease: Back.easeInOut }, "frame3+=2.6")
			.from(".ui2", 0.75, { scale: 0.1, ease: Back.easeInOut }, "frame3+=2.6")
			.to(".app-icon", 0.75, { x: -48 , ease: Back.easeInOut }, "frame3+=2.6")

      // Frame 4
         .add("frame4", "-=.5")
			.set(".ui1, .pill1, .pill2", { autoAlpha: 0 }, "frame4+=.25")
			.set(".ui2", { autoAlpha: 1 }, "frame4+=.25")
			.from(".frame-3-ui-2, .frame-3-ui-1", 0.5, { scale: .75, autoAlpha: 0 , stagger: 0.25, ease:Back.easeOut}, "frame4+=.25")
			.from(text3.chars, 0.01, { autoAlpha: 0, stagger: 0.07 }, "frame4+=1")

      // Frame 5
         .add("frame5", "+=.65")
			.set( ".frame1-container, .endframe-container", { autoAlpha: 1, scale: 1 }, "frame4" )
			.to( ".frame2-container", 1, { x: -600, ease: Power2.easeInOut }, "frame5+=.25" )
			.to( ".f2-stagger", 0.6, { x: -600, stagger: 0.1, ease: Power2.easeInOut }, "frame5" )
			.from( text5.words, 0.6, { autoAlpha: 0, y: 10, stagger: 0.08, ease: Power1.easeOut }, "frame5+=.9" )
			.to(".background2", 1, { x: -728, ease: Power2.easeInOut }, "frame5")
			.from( ".icon-end", 0.75, { x: 728, stagger: 0.05, ease: Power2.easeInOut }, "frame5+=.25" )

			.seek(seekStart);
			// .seek(seekStart)
			// .pause();

		document.querySelector(".stage").addEventListener("click", function () {
			window.open(clickTag);
		});
})();
